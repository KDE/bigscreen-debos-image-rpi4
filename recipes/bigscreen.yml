{{- $architecture := or .architecture "arm64" -}}

architecture: {{ $architecture }}

actions:
  - action: apt
    description: Mycroft Big screen specific packages
    packages:
      - plasma-nano
      - plasma-bigscreen
      - mycroft-skill-installer
      - kio-extras
      - plasma-workspace-wallpapers
      - python3-pip
      - plasma-settings
      - kde-config-mobile-networking
      - kwin-x11
      - python3-websocket
      - cec-utils
      - libcec-dev
      - falkon
      - aura-browser
      - firefox
      - pavucontrol
      - gltron
      - kblocks
      - extremetuxracer
      - kate
      - dolphin
      - python3-dbus
      - python3-pyqt5
      - unclutter
      #- raspi-userland

  - action: download
    url: https://mycroft.blue-systems.com/mycroft-skills-{{ $architecture }}.tar.gz
    name: mycroft-skills
    filename: mycroft-skills-{{ $architecture }}.tar.gz

  - action: overlay
    origin: mycroft-skills
    source: .
    destination: /var/tmp/mycroft-skills-{{ $architecture }}.tar.gz

  - action: download
    url: https://mycroft.blue-systems.com/dotmycroft-setup-{{ $architecture }}.tar.gz
    name: dotmycroft
    filename: dotmycroft-setup-{{ $architecture }}.tar.gz

  - action: overlay
    origin: dotmycroft
    source: .
    destination: /var/tmp/dotmycroft-setup-{{ $architecture }}.tar.gz

  - action: overlay
    description: Plasma for embedded systems specific overlay
    source: ../overlays/base-embedded

  - action: overlay
    description: Mycroft Big screen specific overlay
    source: ../overlays/bigscreen
    
#  - action: run
#    description: Setting up CEC
#    chroot: true
#    script: ../scripts/03-setup_cec.sh
#
  - action: run
    description: Setting up Skills
    chroot: true
    script: ../scripts/93-prepare-bigscreen-skills.sh {{ $architecture }}
#
#  - action: download
#    url: https://mycroft.blue-systems.com/appimage_cli_tool_0_1_6_ubuntu_bionic-arm64.deb
#    name: appimage-cli-tool
#    filename: appimage_cli_tool_0_1_6_ubuntu_bionic-arm64.deb
#    
#  - action: overlay
#    origin: appimage-cli-tool
#    source: .
#    destination: /var/tmp/appimage_cli_tool_0_1_6_ubuntu_bionic-arm64.deb
#
#  - action: run
#    description: Setting up Appimage CLI Tool
#    chroot: true
#    script: ../scripts/95-prepare-appimage-cli-tool.sh
#
#  - action: run
#    description: Setting up AutoResolution Script
#    chroot: true
#    script: ../scripts/96-prepare-auto-resolution.sh
